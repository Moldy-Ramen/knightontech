(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[953],{5362:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/success",function(){return t(5628)}])},5628:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var l=t(7876),a=t(6709),r=t(4232),n=t(9099);function i(){let{clearCart:e}=(0,a._)(),{payment_intent:s}=(0,n.useRouter)().query,[t,i]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),[o,x]=(0,r.useState)(""),[h,m]=(0,r.useState)(!1),[p,u]=(0,r.useState)("");return(0,r.useEffect)(()=>{e()},[]),(0,r.useEffect)(()=>{s&&(async()=>{d(!0),x("");try{let e=await fetch("/api/payment-receipt?payment_intent=".concat(s));if(!e.ok){let s=await e.json();throw Error(s.error||"Failed to load receipt")}let t=await e.json();i(t);let l=await fetch("/api/orders/".concat(s));if(l.ok){let{order:e}=await l.json();(null==e?void 0:e.orderNumber)&&(u(e.orderNumber),await fetch("/api/get-receipt-pdf?orderNumber=".concat(e.orderNumber)),m(!0))}}catch(e){console.error("Error fetching data:",e),x("Something went wrong. Please try again later.")}finally{d(!1)}})()},[s]),(0,l.jsxs)("div",{className:"min-h-screen bg-black text-white font-sans flex flex-col justify-between",children:[(0,l.jsx)("nav",{className:"bg-[#1f2937] shadow z-20 relative",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-3 flex justify-between items-center",children:[(0,l.jsx)("a",{href:"/",className:"flex items-center",children:(0,l.jsx)("img",{src:"/img/Knighton_Tech_Full _White.png",alt:"Knighton Tech",className:"h-10 w-auto"})}),(0,l.jsxs)("ul",{className:"hidden md:flex space-x-6 text-sm font-medium items-center",children:[(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"/",className:"hover:text-blue-400",children:"Home"})}),(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"/services",className:"hover:text-blue-400",children:"Services"})}),(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"/store",className:"hover:text-blue-400",children:"Store"})}),(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"/contact",className:"hover:text-blue-400",children:"Contact Us"})}),(0,l.jsx)("li",{children:(0,l.jsxs)("a",{href:"/cart",className:"flex items-center hover:text-blue-400",children:["\uD83D\uDED2",(0,l.jsx)("span",{className:"ml-1",children:"Cart"})]})})]})]})}),(0,l.jsxs)("main",{className:"relative flex-1 overflow-hidden",children:[(0,l.jsx)("div",{className:"absolute inset-0 w-full h-full bg-cover bg-center blur-sm brightness-50 z-0",style:{backgroundImage:"url('/img/hero-background.jpg')"}}),(0,l.jsxs)("div",{className:"relative z-10 max-w-2xl mx-auto px-4 py-16 space-y-6",children:[s?c?(0,l.jsx)("h1",{className:"text-4xl font-bold text-green-400 text-center",children:"Loading your receiptâ€¦"}):o?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h1",{className:"text-4xl font-bold text-red-400 text-center",children:"Something went wrong"}),(0,l.jsx)("p",{className:"text-center text-gray-300",children:o})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h1",{className:"text-4xl font-bold text-green-400 text-center",children:"Thank you for your order!"}),p&&(0,l.jsxs)("p",{className:"text-center text-gray-300",children:[(0,l.jsx)("span",{className:"font-semibold",children:"Order #:"})," ",p]}),p&&(0,l.jsx)("div",{className:"text-center mt-4",children:(0,l.jsx)("button",{onClick:()=>{p&&window.open("/api/get-receipt-pdf?orderNumber=".concat(p,"&ts=").concat(Date.now()),"_blank")},className:"bg-blue-600 hover:bg-blue-500 px-6 py-3 rounded text-white font-semibold",children:"Download Receipt"})})]}):(0,l.jsx)("h1",{className:"text-4xl font-bold text-red-400 text-center",children:"No payment reference found."}),c&&(0,l.jsx)("p",{className:"text-center text-gray-300",children:"Please wait while we fetch your receipt."}),!c&&t&&(0,l.jsxs)("div",{className:"bg-gray-900 p-6 rounded-lg space-y-6",children:[(0,l.jsxs)("section",{className:"space-y-2",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold",children:"Order Receipt"}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-semibold",children:"Name:"})," ",t.customer_name]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-semibold",children:"Email:"})," ",t.customer_email]}),t.customer_phone&&(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-semibold",children:"Phone:"})," ",t.customer_phone]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"font-semibold",children:"Shipping Address:"}),(0,l.jsxs)("p",{children:[t.shipping_address.line1,", ",t.shipping_address.city,","," ",t.shipping_address.state," ",t.shipping_address.postal_code,","," ",t.shipping_address.country]})]}),(0,l.jsxs)("p",{className:"text-gray-400 text-sm",children:["Order Date:"," ",new Date(1e3*t.created).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"})]})]}),(0,l.jsxs)("section",{children:[(0,l.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Items"}),(0,l.jsx)("div",{className:"divide-y divide-gray-700",children:t.line_items.map((e,s)=>(0,l.jsxs)("div",{className:"flex justify-between items-start py-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:e.description}),(0,l.jsxs)("p",{className:"text-gray-400 text-sm",children:["Qty: ",e.quantity]})]}),(0,l.jsxs)("p",{className:"font-semibold",children:["$",null!=e.amount?e.amount.toFixed(2):"0.00"]})]},s))})]}),(0,l.jsxs)("section",{className:"space-y-2 pt-4 border-t border-gray-700",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("p",{className:"text-gray-400",children:"Tax"}),(0,l.jsxs)("p",{className:"font-semibold",children:["$",null!=t.tax?t.tax.toFixed(2):"0.00"]})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("p",{className:"text-gray-400",children:"Shipping"}),(0,l.jsxs)("p",{className:"font-semibold",children:["$",null!=t.shipping?t.shipping.toFixed(2):"0.00"]})]}),(0,l.jsxs)("div",{className:"flex justify-between text-lg font-semibold",children:[(0,l.jsx)("p",{children:"Total"}),(0,l.jsxs)("p",{children:["$",null!=t.total?t.total.toFixed(2):"0.00"]})]})]}),h&&(0,l.jsx)("p",{className:"text-green-400 text-sm text-center",children:"Your receipt will be E-Mailed to you shortly."}),(0,l.jsx)("div",{className:"text-center pt-4",children:(0,l.jsx)("a",{href:"/store",className:"inline-block bg-blue-600 hover:bg-blue-500 px-6 py-3 rounded text-white font-semibold",children:"Back to Store"})})]})]})]}),(0,l.jsx)("footer",{className:"bg-[#1f2937] text-center py-4 text-sm text-gray-400 z-10 relative",children:"\xa9 2025 Knighton Tech. All rights reserved."})]})}},9099:(e,s,t)=>{e.exports=t(8253)}},e=>{var s=s=>e(e.s=s);e.O(0,[636,593,792],()=>s(5362)),_N_E=e.O()}]);