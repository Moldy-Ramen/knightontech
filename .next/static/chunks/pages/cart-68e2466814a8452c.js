(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[442],{2612:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return t(8755)}])},8755:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var a=t(7876),l=t(6709),r=t(4232),i=t(1902);function n(){let{cart:e,removeFromCart:s,clearCart:t}=(0,l._)(),[n,c]=(0,r.useState)(!1),d=(0,i.useStripe)(),o=(0,i.useElements)(),[h,x]=(0,r.useState)({name:"",email:"",phone:"",address:{line1:"",city:"",state:"",postal_code:"",country:"US"}}),[m,p]=(0,r.useState)([]),[u,g]=(0,r.useState)(null),[f,b]=(0,r.useState)(null),[y,j]=(0,r.useState)(null),[N,v]=(0,r.useState)(!1),[w,C]=(0,r.useState)(!1),_=e.reduce((e,s)=>e+(parseFloat(s.price.replace("$",""))||0)*s.qty,0).toFixed(2),S=(.0725*parseFloat(_)).toFixed(2),k=(null==f?void 0:f.rate)?parseFloat(f.rate):0,F=(parseFloat(_)+parseFloat(S)+k).toFixed(2),E=e=>{let{name:s,value:t}=e.target;s in h.address?x(e=>({...e,address:{...e.address,[s]:t}})):x(e=>({...e,[s]:t}))},P=async()=>{v(!0),j(null),p([]),b(null),g(null);let{name:e,phone:s,address:t}=h;if(!e||!s||!t.line1||!t.city||!t.state||!t.postal_code||!t.country){j("Please fill out all shipping fields."),v(!1);return}try{let a=await fetch("/api/shipping-estimate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,phone:s,address:t})}),l=await a.json();if(a.ok){let e=(l.rates||[]).filter(e=>"USPS"===e.carrier||e.carrier.includes("FedEx"));p(e)}else j(l.error||"Failed to get shipping estimate.")}catch(e){console.error("Fetch error:",e),j("Network error while fetching shipping.")}finally{v(!1)}},T=e=>{g(e),b(m.find(s=>s.id===e))},D=async()=>{if(!d||!o)return;let s=o.getElement(i.CardElement),a=w?"Local Pickup":f?"".concat($(f.carrier)," – ").concat(f.service):"Unknown",l=await fetch("/api/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:e,name:h.name,email:h.email,phone:h.phone,address:h.address,shipping:w?{method:"Local Pickup"}:f,tax:S,total:F,deliveryOption:a})}),r=await l.json();if(!r.client_secret)return void alert("Failed to initiate payment.");let{error:n,paymentIntent:c}=await d.confirmCardPayment(r.client_secret,{payment_method:{card:s,billing_details:{name:h.name,email:h.email,phone:h.phone,address:h.address}}});n?alert("Payment failed: ".concat(n.message)):"succeeded"===c.status&&(t(),window.location.href="/success?payment_intent=".concat(c.id))},$=e=>e.replace(/Default$/,""),A=e=>null!=e.delivery_days?"".concat(e.delivery_days," day").concat(e.delivery_days>1?"s":""):e.estimated_delivery?new Date(e.estimated_delivery).toLocaleDateString():"N/A";return(0,a.jsxs)("div",{className:"min-h-screen bg-black text-white font-sans flex flex-col justify-between",children:[(0,a.jsx)("nav",{className:"bg-[#1f2937] shadow z-20 relative",children:(0,a.jsxs)("nav",{className:"bg-[#1f2937] shadow z-20 relative",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-3 flex justify-between items-center",children:[(0,a.jsx)("a",{href:"/",className:"flex items-center",children:(0,a.jsx)("img",{src:"/img/Knighton_Tech_Full _White.png",alt:"Knighton Tech",className:"h-10 w-auto"})}),(0,a.jsxs)("ul",{className:"hidden md:flex space-x-6 text-sm font-medium items-center",children:[(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"/",className:"hover:text-blue-400",children:"Home"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"/services",className:"hover:text-blue-400",children:"Services"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"/store",className:"hover:text-blue-400",children:"Store"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"/contact",className:"hover:text-blue-400",children:"Contact Us"})}),(0,a.jsx)("li",{className:"relative",children:(0,a.jsxs)("a",{href:"/cart",className:"flex items-center hover:text-blue-400",children:["\uD83D\uDED2",(0,a.jsx)("span",{className:"ml-1",children:"Cart"}),e.length>0&&(0,a.jsx)("span",{className:"absolute -top-2 -right-3 bg-red-600 text-white text-xs font-bold px-2 py-0.5 rounded-full",children:e.length})]})})]}),(0,a.jsx)("button",{className:"md:hidden focus:outline-none",onClick:()=>c(!n),children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]}),n&&(0,a.jsx)("div",{className:"md:hidden px-4 pb-4",children:(0,a.jsxs)("ul",{className:"flex flex-col space-y-2 text-sm font-medium",children:[(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"/",className:"hover:text-blue-400",children:"Home"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"/services",className:"hover:text-blue-400",children:"Services"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"/store",className:"hover:text-blue-400",children:"Store"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"/contact",className:"hover:text-blue-400",children:"Contact Us"})}),(0,a.jsx)("li",{children:(0,a.jsxs)("a",{href:"/cart",className:"hover:text-blue-400",children:["Cart (",e.length,")"]})})]})})]})}),(0,a.jsxs)("main",{className:"relative flex-1 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 w-full h-full bg-cover bg-center blur-sm brightness-50 z-0",style:{backgroundImage:"url('/img/hero-background.jpg')"}}),(0,a.jsxs)("div",{className:"relative z-10 max-w-4xl mx-auto px-4 py-16 space-y-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-center",children:"Shopping Cart"}),0===e.length?(0,a.jsx)("p",{className:"text-center text-gray-400",children:"Your cart is empty."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:e.name}),(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:e.specs}),(0,a.jsxs)("p",{className:"text-sm mt-1",children:["Quantity: ",e.qty]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-green-400 font-bold",children:e.price}),(0,a.jsx)("button",{onClick:()=>s(e.id),className:"text-red-400 hover:text-red-300 text-sm mt-2",children:"Remove"})]})]},e.id))}),(0,a.jsxs)("div",{className:"bg-gray-900 p-6 rounded-lg",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold border-b border-gray-700 pb-2 mb-4",children:"Shipping Information"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,a.jsx)("input",{id:"localPickup",type:"checkbox",checked:w,onChange:()=>C(!w),className:"w-4 h-4 text-blue-600 bg-gray-800 border-gray-700 focus:ring-blue-500"}),(0,a.jsx)("label",{htmlFor:"localPickup",className:"text-white text-sm",children:"I want to pick this up locally (no shipping)"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("input",{type:"text",name:"name",placeholder:"Full Name",value:h.name,onChange:E,className:"w-full h-10 px-3 bg-gray-700 text-white rounded border border-gray-600 focus:ring-2 focus:ring-indigo-500"}),(0,a.jsx)("input",{type:"email",name:"email",placeholder:"Email Address",value:h.email,onChange:E,className:"w-full h-10 px-3 bg-gray-700 text-white rounded border border-gray-600 focus:ring-2 focus:ring-indigo-500"}),(0,a.jsx)("input",{type:"tel",name:"phone",placeholder:"Phone Number",value:h.phone,onChange:E,className:"w-full h-10 px-3 bg-gray-700 text-white rounded border border-gray-600 focus:ring-2 focus:ring-indigo-500"}),(0,a.jsx)("input",{type:"text",name:"line1",placeholder:"Street Address",value:h.address.line1,onChange:E,className:"w-full h-10 px-3 bg-gray-700 text-white rounded border border-gray-600 focus:ring-2 focus:ring-indigo-500"}),(0,a.jsx)("input",{type:"text",name:"city",placeholder:"City",value:h.address.city,onChange:E,className:"w-full h-10 px-3 bg-gray-700 text-white rounded border border-gray-600 focus:ring-2 focus:ring-indigo-500"}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("input",{type:"text",name:"state",placeholder:"State (e.g. UT)",value:h.address.state,onChange:E,className:"w-1/2 h-10 px-3 bg-gray-700 text-white rounded border border-gray-600 focus:ring-2 focus:ring-indigo-500"}),(0,a.jsx)("input",{type:"text",name:"postal_code",placeholder:"ZIP Code",value:h.address.postal_code,onChange:E,className:"w-1/2 h-10 px-3 bg-gray-700 text-white rounded border border-gray-600 focus:ring-2 focus:ring-indigo-500"})]}),(0,a.jsx)("input",{type:"hidden",name:"country",value:h.address.country}),!w&&(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("button",{onClick:P,disabled:N,className:"".concat(N?"bg-gray-600 cursor-not-allowed":"bg-green-600 hover:bg-green-500"," px-4 py-2 rounded text-white font-medium transition-colors"),children:N?"Estimating…":"Get Shipping Estimate"}),y&&(0,a.jsx)("p",{className:"text-red-400 text-sm",children:y})]})]}),!w&&Array.isArray(m)&&m.length>0&&(0,a.jsxs)("div",{className:"mt-6 bg-gray-800 p-4 rounded-lg text-sm w-full max-h-64 overflow-y-auto",children:[(0,a.jsx)("h3",{className:"font-semibold mb-3 text-white",children:"Select Shipping Option"}),(0,a.jsx)("div",{className:"space-y-2",children:m.map(e=>(0,a.jsxs)("label",{className:"flex items-center justify-between bg-gray-700 p-3 rounded-lg hover:bg-gray-600 cursor-pointer ".concat(u===e.id?"ring-2 ring-indigo-500":""),children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("input",{type:"radio",name:"shippingRate",value:e.id,checked:u===e.id,onChange:()=>T(e.id),className:"form-radio h-5 w-5 text-indigo-500 mt-1"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("p",{className:"font-semibold text-white",children:[$(e.carrier)," – ",e.service]}),(0,a.jsxs)("p",{className:"text-xs text-gray-300",children:["Delivery: ",A(e)]})]})]}),(0,a.jsxs)("div",{className:"text-white font-semibold",children:["$",parseFloat(e.rate).toFixed(2)]})]},e.id))})]}),!w&&f&&(0,a.jsxs)("div",{className:"mt-4 bg-green-700 px-3 py-2 rounded-lg text-sm w-full",children:[(0,a.jsxs)("p",{className:"font-semibold",children:[$(f.carrier)," –"," ",f.service," – $",parseFloat(f.rate).toFixed(2)]}),null!=f.delivery_days&&(0,a.jsxs)("p",{className:"text-xs",children:["ETA: ",f.delivery_days," day",1!==f.delivery_days?"s":""]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-900 p-6 rounded-lg mt-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Card Information"}),(0,a.jsx)("div",{className:"p-4 bg-gray-800 rounded text-white",children:(0,a.jsx)(i.CardElement,{options:{style:{base:{fontSize:"16px",color:"#ffffff","::placeholder":{color:"#888"}},invalid:{color:"#e5424d"}}}})})]}),(0,a.jsxs)("div",{className:"flex justify-between items-start mt-8 border-t border-gray-600 pt-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-lg",children:["Subtotal: ",(0,a.jsxs)("span",{className:"font-semibold",children:["$",_]})]}),(0,a.jsxs)("p",{className:"text-lg",children:["Tax (7.25%): ",(0,a.jsxs)("span",{className:"font-semibold",children:["$",S]})]}),!w&&f&&(0,a.jsxs)("p",{className:"text-lg",children:["Shipping:"," ",(0,a.jsxs)("span",{className:"font-semibold",children:["$",k.toFixed(2)]})]}),(0,a.jsxs)("p",{className:"text-xl font-semibold mt-1",children:["Total: ",(0,a.jsxs)("span",{children:["$",F]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)("button",{onClick:t,className:"text-red-400 hover:text-red-300 text-sm",children:"Clear Cart"}),(0,a.jsx)("button",{onClick:D,disabled:!d||0===e.length||!w&&!f,className:"".concat(d&&0!==e.length&&(w||f)?"bg-green-600 hover:bg-green-500":"bg-gray-600 cursor-not-allowed"," px-4 py-2 rounded text-white font-medium transition-colors"),children:"Checkout"})]})]})]})]})]}),(0,a.jsx)("footer",{className:"bg-[#1f2937] text-center py-4 text-sm text-gray-400 z-10 relative",children:"\xa9 2025 Knighton Tech. All rights reserved."})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[636,593,792],()=>s(2612)),_N_E=e.O()}]);